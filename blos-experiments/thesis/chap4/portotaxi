#!/bin/bash

# this script produce the result of the real world dataset


# 0.01:0.000015

# DEFAULT VALUES
SKETCH_HH=100
SKETCH_SIZE_DELTA="0.5 0.1 0.05 0.01"
SKETCH_SIZE_EPSILON="0.01 0.001 0.0001 0.000015 0.00001"
DPI=100
FORMAT=png
WINDOW="0.005:0.005"
MIN_GPS="41.12,-8.66"
MAX_GPS="41.18,-8.59"
GPS_RESOLUTION=3
SHORT_TRIP_LENGTH=10 # minutes
RADIUS=100	# in meters
DATA_DIR=~/tmp/blos/experiments/portotaxi/expt1/
HOURS="0:24:1"

# cleanup
rm -r ${DATA_DIR}
mkdir -p ${DATA_DIR}/dataset
mkdir -p ${DATA_DIR}/sketch

NUM=1

echo "random gps pos $RADMOM_GPS2"
IFS=', ' read -r -a LIST_SKETCH_SIZE_DELTA <<< "$SKETCH_SIZE_DELTA"
IFS=', ' read -r -a LIST_SKETCH_SIZE_EPSILON <<< "$SKETCH_SIZE_EPSILON"
for d in "${LIST_SKETCH_SIZE_DELTA[@]}"
do
	for e in "${LIST_SKETCH_SIZE_EPSILON[@]}"
	do
		SKETCH_SIZE="${d}:${e}"
		SKETCH_FILE=${d}_${e}

		rm -r ${DATA_DIR}/sketch/${SKETCH_FILE}
		mkdir -p ${DATA_DIR}/sketch/${SKETCH_FILE}


		for i in $(seq 1 $NUM); do
			RANDOM_GPS=$(blos experiments random-gps $MIN_GPS $MAX_GPS)
			RADMOM_GPS2=$(echo "$RANDOM_GPS" | tr ',' ':' )

			blos examples run eu.blos.scala.examples.portotaxi.PortoTaxi \
				--input /home/kay/Dropbox/kay-rep/Uni-Berlin/Masterarbeit/Sources/blos/datasets/portotaxi/taxi2.tsv \
				--output ${DATA_DIR}/sketch/${SKETCH_FILE}/taxi_dataset_result_${RADMOM_GPS2}.tsv \
				--sketch ${SKETCH_SIZE} \
				--center ${RADMOM_GPS2} \
				--window ${WINDOW} \
				--resolution ${GPS_RESOLUTION} \
				--shorttriplength ${SHORT_TRIP_LENGTH} \
				--radius ${RADIUS} \
				--hours ${HOURS}

		done
	done
done
